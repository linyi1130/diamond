<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>Title</title></head><body><div><div class="ui form">    <div class="inline fields">    <div class="ui field">        <label>角色</label>        <select class="ui selected dropdown" id="roles" onchange="get_tree()">            <option value="">请选择角色</option>            {% for t in tb_group %}            <option value={{ t.group_id }}>{{ t.group_name }}</option>            {% endfor %}        </select>    </div>    <div class="ui field">        <label>&nbsp;</label>        <button class="ui positive button" onclick="reg()">修改</button>    </div>    </div></div><div class="ui celled relaxed list">{% for key,value in menu.items %}    <div class="item">        <div class="ui master checkbox">            <input type="checkbox" name="menu_l1">            <label>{{ key }}</label>        </div>        <div class="list">        {% for t in value %}            <div class="item">                <div class="ui child checkbox">                    <input type="checkbox" name="menu_l2" id="menu{{ t.0 }}" value={{ t.0 }}>                    <label>{{ t.1 }}</label>                </div>            </div>        {% endfor %}        </div>    </div>{% endfor %}</div></div><script>    $('.list .master.checkbox')  .checkbox({    // check all children    onChecked: function() {      var        $childCheckbox  = $(this).closest('.checkbox').siblings('.list').find('.checkbox')      ;      $childCheckbox.checkbox('check');    },    // uncheck all children    onUnchecked: function() {      var        $childCheckbox  = $(this).closest('.checkbox').siblings('.list').find('.checkbox')      ;      $childCheckbox.checkbox('uncheck');    }  });$('.list .child.checkbox')  .checkbox({    // Fire on load to set parent value    fireOnInit : true,    // Change parent state on each child checkbox change    onChange   : function() {      var        $listGroup      = $(this).closest('.list'),        $parentCheckbox = $listGroup.closest('.item').children('.checkbox'),        $checkbox       = $listGroup.find('.checkbox'),        allChecked      = true,        allUnchecked    = true      ;      // check to see if all other siblings are checked or unchecked      $checkbox.each(function() {        if( $(this).checkbox('is checked') ) {          allUnchecked = false;        }        else {          allChecked = false;        }      });      // set parent checkbox state, but dont trigger its onChange callback      if(allChecked) {        $parentCheckbox.checkbox('set checked');      }      else if(allUnchecked) {        $parentCheckbox.checkbox('set unchecked');      }      else {        $parentCheckbox.checkbox('set indeterminate');      }    }  });</script><script>    $(document).ready(function () {        $('.ui.dropdown').dropdown()    })</script><script>    function get_tree() {       $('.ui.checkbox').checkbox('uncheck');       var group_id= $('#roles').dropdown('get value');        $.ajax({            url:'/get_treel2/',            type:'post',            data:{'group_id':group_id},            success:function (result) {                var tree_list=[];                $.each(JSON.parse(result),function (key,value) {                    tree_list.push(value);                });                for(var i=0;i<tree_list.length;i++){                    var checkid='menu' + tree_list[i];                    $('#'+ checkid+"").prop('checked',true)                }            }        })    }</script><script>    function reg() {        var len=$('.ui.child.checkbox').length;        var tmp=$('#menu10').val()        //alert(tmp)        var list= new Array();        for (var i=0;i<=len;i++){            var checkid='menu' + i;            var flag=$('#'+ checkid+"").prop('checked');            var tree_id=$('#'+ checkid+"").val();            var item=[tree_id,flag];            list.push(item)        }        var group_id=$('#roles').dropdown('get value');        $.ajax({            url:'/modify_permission_menu/',            type:'post',            traditional:true,            data:{'list':list,'group_id':group_id},            success: function (result) {                alert('修改影响'+ result + "个菜单权限")            }        })    }</script></body></html>