<!DOCTYPE html><html lang="zh"><head>    <meta charset="UTF-8">    <title>牌局列表</title></head><body><div id="content">    <table class="ui  small celled stackable striped  table">        <thead>            <tr>                <th>编号</th>                <th>游戏</th>                <th>盲注</th>                <th>straddle</th>                <th>开始时间</th>                <th>时长</th>                <th>状态</th>                <th>开局客服</th>                <th>操作</th>            </tr>        </thead>        <tbody>            {% for t in table_list %}            <tr>                <td>{{ t.0 }}</td>                <td>{{ t.1 }}</td>                <td>{{ t.2 }}</td>                <td>{{ t.3 }}</td>                <td>{{ t.4 }}</td>                <td>{{ t.5 }}</td>                <td>{{ t.6 }}</td>                <td>{{ t.7 }}</td>                <td><div class="ui dropdown icon item">                    <i class="wrench icon"></i>                        <div class="menu">                        <div class="item" name="buy_in">带入</div>                        <div class="item" name="finish">结束</div>                        <div class="item" name="reward">奖励</div>                        <div class="item" name="abort">作废</div>                        </div>                    </div>                </td>              {% endfor %}            </tr>        </tbody>    </table>    <div class="ui scrolling  modal" id="buy" >        <h2 class="ui header">牌局编号</h2><label class="ui red ribbon label" id="game_no"></label>        <div class="scrolling content" id="buyin_reg">        </div>    </div>    <div class="ui small modal" id="message">        <h2 class="header">错误信息</h2>        <div class="content">            <p id="msg"></p>        </div>        <div class="actions">            <button class="ui negative button" onclick="reflesh()">返回</button>        </div>    </div>    <div class="ui modal" id="reward">        <h2 class="header">牌局奖励</h2>        <div class="content">        <div class="ui form">            <div class="field">                <label>玩家</label>                <select class="ui selected dropdown" id="reward_user">                    <option value="">请选择玩家</option>                </select>            </div>            <div class="field">                <label>选择牌型</label>                <select class="ui selected dropdown" id="rewardlist" onchange="setreward()">                    <option value="">选择牌型</option>                </select>            </div>            <div class="field">                <label>奖励标准</label>                <input type="text" id="reward_value" value="">            </div>        </div>        </div>        <div class="actions">            <button class="ui positive button">确认</button>            <button class="ui negative button">返回</button>        </div>    </div></div><script>$(document).ready(function () {    $('.ui.dropdown').dropdown();});    $("div[name='buy_in']").click(function buy_in() {        $.ajaxSetup({async: true});        var msg=$(this).parents("tr").find("td").eq(0).text();        $('#game_no').text(msg)        $('#buyin_reg').load('/table_reg_mini/', {'gameno':msg},function () {            $('#buy').modal({            autofocus: false        });            $('#buy').modal('show');        });    });    $("div[name=abort]").click(function () {        $.ajaxSetup({async: true});        var gameno=$(this).parents("tr").find("td").eq(0).text();        $.ajax({            url:"/abortgame/",            type: 'post',            data: {'game_no': gameno},            success: function (result) {                location.reload()            }        })    });    $("div[name=finish]").click(function () {        var gameno=$(this).parents("tr").find("td").eq(0).text();        $.ajax({            url:'/getGameStatus/',            type:'post',            data:{'game_no':gameno},            success: function (result) {                if (result==="True")                {                    var url="/result"+"?game_no="+gameno;                    window.open(url)                }                else {                    $('#msg').text("该牌局已经导入，请刷新列表");                    $('#message').modal('show');                }            }        })        //$(top.location).attr("href","/result/","_blank")    });    function reflesh() {        location.reload()    };    $("div[name=reward]").click(function () {         var game_no=$(this).parents("tr").find("td").eq(0).text();         $.ajax({             url:'/reward_normol_form/',             type:'post',             data:{'game_no': game_no},             datatype:'json',             success: function (result) {                 $('#reward_user').empty();                 $.each(JSON.parse(result), function (key,value) {                     if (key==='user_list')                     {                         var tmp=value.toString();                         var userlist=tmp.split(",");                         var lenth=userlist.length;                         for ( var t=0;t<lenth;t=t+3){                             var list='<option class="item" value='+ userlist[t] +','+userlist[t+1]+ '>' + userlist[t+2] + '</option>';                             $('#reward_user').append(list);                         }                     }                     if (key==='tb_reward')                     {                         var tmp=value.toString();                         var rewardlist=tmp.split(",");                         var lenth=rewardlist.length;                         for ( var t=0;t<lenth;t=t+2){                             var list='<option class="item" value='+ rewardlist[t+1] + '>' + rewardlist[t] + '</option>';                             $('#rewardlist').append(list);                         }                     }                     $('#reward').modal({                            autofocus: false                        });                     $('#reward').modal('show');                 })             }         })    })</script><script>    function setreward() {        var reward=$('#rewardlist').dropdown('get value');        $('#reward_value').val(parseFloat(reward/1000));    }</script></body></html>