<!DOCTYPE html>{% load static %}<html lang="zh"><head>    <meta charset="UTF-8">    <title>用户信息修改</title>    <link rel="stylesheet" href="{% static 'semantic/semantic.css'%}">    <script src="https://code.jquery.com/jquery-1.12.4.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.js"></script></head><body><div id="sidebar" ></div><div class="dimmed pusher"><div class="ui labeled icon button" id="menu">		<i class="sidebar icon"></i>		导航		</div>    <div class="ui doubling stackable container" style="padding: 50px">        <div class="ui five item inverted menu">		<a class="item" id="a">出纳台</a>		<a class="item" id="b">玩家管理</a>		<a class="item" id="c">牌局管理</a>		<a class="item" id="d">实时报表</a>		<a class="item" id="e">俱乐部管理</a>		</div>        <div class="ui small modal">        <h2 class="header">处理结果</h2>        <div class="content">            <p id="msg1"></p>        </div>        <div class="actions">            <button class="ui negative button" onclick="messageconfirm()">返回</button>        </div>    </div>        <div class="ui form" name="user_info" id="user_info" method="post">            <label for="user_list">搜索玩家</label>        <select class="ui search selection dropdown" name="user_list" id="user_list" onchange="search()">            <i class="search link icon"></i>            <option class="item" value="">点击搜索</option>            {% for t in tb_user %}            <option class="item" value={{ t.0 }}>{{ t.2 }}</option>            {% endfor %}        </select>            <h4 class="ui dividing pink header">用户信息修改</h4>            <div class="two fields">                <div class="field">                    <label>游戏名称</label>                <input type="text" name="new_name" id="new_name" value={{ user_name }}>                </div>                    <div class="field">                    <label>微信名称</label>                <input type="text" name="wx_name" id="wx_name" value={{ tb_result.wx_name }}>                </div>            </div>            <div class="two fields">                <div class="field">                    <label>主账户</label>                <input type="text" name="main_account" id="main_account" readonly="true" value={{ tb_result.main_account }}>                </div>                    <div class="field">                    <label>同账户玩家</label>                <input type="text" name="account_list" id="account_list" readonly="true" value={{ tb_result.tb_account_list }}>                </div>            </div>            <div class="two fields">                <div class="field">                    <label>归属俱乐部</label>                <input type="text" name="club_list" id="club_list" readonly="true" value={{ tb_result.club_list }} >                </div>                    <div class="field">                    <label>拉手</label>                <input type="text" name="develop" id="develop" readonly="true" >                </div>            </div>            <div>                <label>备注</label>                <input type="text" name="note" id="note" value={{ tb_result.note }}>            </div>            <div class="ui hidden divider"></div>            <button class="ui button primary" onclick="modifyuser()">修改</button>            <button class="ui button negative">放弃</button>              <input type="hidden" id="user_id" value="">              <input type="hidden" id="old_name" type="text" value="">              <input type="hidden"  id="old_wx_name" type="text" value="">              <input type="hidden" id="old_note" type="text" value="">        </div>      <div class="ui info message">            <div class="header">操作提示</div>            <ul class="list"></ul>                <li>玩家名称全联盟唯一，修改后全联盟生效</li>                <li>请确保在改名前原玩家名没有在未结算的牌局中</li>      </div></div></div><script>	$(document).ready(function(){        $('.ui.dropdown').dropdown();		$("#sidebar").load("{% static 'template/sidebar.html'%}");        $("#b").addClass('active red item');	}					 )            $("#menu").click(function(){            $('.ui.sidebar').sidebar('toggle');        })</script><script>    $('#user_info').form({    on:'blur',    inline:true,    fields:{        new_name:{            identifier:'new_name',            rules:[{                type:'empty',                prompt:'玩家名不能为空'            }]        },        wx_name:{            identifier: 'wx_name',            rules:[{                type:'empty',                prompt:'微信名不能为空'            }]        }    }})</script><script>    function search() {        var seacrh_name = $('#user_list').dropdown('get text');        $.ajax({            url : '/searchUser/',            type : 'post',            datatype: "json",            data:{'user_name': seacrh_name},            success:function (result) {                if(result!="False")                {                    var dic=[];                    $.each(JSON.parse(result), function (key, value) {                        dic[key]=value;                        //alert(dic[key]);                    })                    $('#new_name').val(seacrh_name);                    $('#wx_name').val(dic['wx_name']);                    $('#main_account').val(dic['main_account']);                    $('#account_list').val(dic['tb_account_list']);                    $('#club_list').val(dic['club_list']);                    $('#note').val(dic['note']);                    $('#user_id').val(dic['user_id']);                    $('#old_name').val(seacrh_name);                    $('#old_wx_name').val(dic['wx_name']);                    $('#old_note').val(dic['note']);                }            }        })    }</script><script>    function modifyuser() {            $.ajaxSetup({async: true});            var new_name=$.trim($('#new_name').val());            var user_id=$.trim($('#user_id').val());            var wx_name=$.trim($('#wx_name').val());            var note=$.trim($('#note').val());            var old_name=$('#old_name').val();            var old_wx_name=$('#old_wx_name').val();            var old_note=$('#old_note').val();            var pp=(new_name==old_name && wx_name==old_wx_name && note==old_note);            if (pp)            {                $('#msg1').text("没有任何修改");                $('.ui.modal').modal('show');            }            else{                $.ajax({                    type:'post',                    url:'/modifyUserInfo/',                    data:{'user_name': new_name, 'user_id':user_id, 'wx_name':wx_name,                        'note':note, 'old_name':old_name,'old_wx_name':old_wx_name,'old_note':old_note},                    success: function (result) {                        if (result=="玩家名字已存在")                        {                            $('#msg1').text("玩家名字已存在");                            $('.ui.modal').modal('show');                        }                        else if(result!="False"){                            $('#msg1').text("修改成功");                            $('.ui.modal').modal('show');                        }                    }                })            }    }            function messageconfirm() {            location.reload();        }</script></body></html>